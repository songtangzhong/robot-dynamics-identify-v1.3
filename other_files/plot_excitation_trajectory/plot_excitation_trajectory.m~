%%
dof=7;
wf=0.1*pi;
Tf=20;
h=0.1;
opt_x=[0.122158, -0.0673772, 0.118962, -0.5961, 0.422357, -0.0563986, 0.0463215, 0.276986, -0.464434, 0.198106, -0.0553738, 0.0266686, 0.0936147, -0.104288, -0.0865345, 0.0705397, -0.100192, -0.108906, 0.668059, -0.174038, -0.198004, -0.0479666, -0.0896767, 0.228809, -0.171992, 0.021487, 0.0113734, -0.0900703, 0.877391, -0.179137, -0.220257, -0.0492545, 0.713007, -0.0493501, 0.307243, -0.0402643, -0.241659, 0.0240304, -0.0234479, 0.17464, 0.814278, -0.645434, -0.0373858, 0.529866, -0.0113434, -0.125686, 0.0262228, 0.389536, -0.278729, -0.0466586, 0.619357, -0.201796, -0.0338548, -0.0902497, 0.538711, 0.115816, 0.122801, 0.0128268, -0.405044, 0.153601, 0.0747564, 0.328862, -0.195539, 0.597245, -0.506968, 0.706409, -0.155805, -0.208229, 0.202712, 0.244835, -0.0835125, 0.0577007, 0.0247075, 0.442485, 0.29427, -0.52233, 0.594128]


count=Tf/h;
opt_q=zeros(count+1,dof);
opt_dq=zeros(count+1,dof);
opt_ddq=zeros(count+1,dof);

t=-h;
for k=1:(count+1)
    t=t+h;
    [opt_q(k,:),opt_dq(k,:),opt_ddq(k,:)]=generate_fourier_trajectory(opt_x,wf,t); 
end

time=0:h:Tf;
close all;
figure;
plot(time,opt_q(:,1),time,opt_q(:,2),time,opt_q(:,3),time,opt_q(:,4),time,opt_q(:,5),time,opt_q(:,6),time,opt_q(:,7),'Linewidth',2);
grid on;
legend('$q_{1}$','$q_{2}$','$q_{3}$','$q_{4}$','$q_{5}$','$q_{6}$','$q_{7}$','Interpreter','Latex');

figure;
plot(time,opt_dq(:,1),time,opt_dq(:,2),time,opt_dq(:,3),time,opt_dq(:,4),time,opt_dq(:,5),time,opt_dq(:,6),time,opt_dq(:,7),'Linewidth',2);
grid on;
legend('$\dot{q}_{1}$','$\dot{q}_{2}$','$\dot{q}_{3}$','$\dot{q}_{4}$','$\dot{q}_{5}$','$\dot{q}_{6}$','$\dot{q}_{7}$','Interpreter','Latex');

figure;
plot(time,opt_ddq(:,1),time,opt_ddq(:,2),time,opt_ddq(:,3),time,opt_ddq(:,4),time,opt_ddq(:,5),time,opt_ddq(:,6),time,opt_ddq(:,7),'Linewidth',2);
grid on;
legend('$\ddot{q}_{1}$','$\ddot{q}_{2}$','$\ddot{q}_{3}$','$\ddot{q}_{4}$','$\ddot{q}_{5}$','$\ddot{q}_{6}$','$\ddot{q}_{7}$','Interpreter','Latex');








